<!DOCTYPE html>
<html>
<head>
<title>cat iframe</title>
</head>
<body>

  <button type="button" onclick ="deleteAllCookies()">Reset cookies</button>
  <button type="button" onclick ="clearLocalStorage()">Clear localStorage</button>
<h1>dummy website</h1>

<script type='text/javascript'>
  domains = ['127.0.0.1', 'thirdpartydomain.com', '2leep.com', 'activengage.com', '63squares.com', 'aamapi.com', 'causes.com', 'cashbeet.com'];
    for (var i = 0; i < domains.length; i++) {
      var img = document.createElement("IMG");
      var url = "http://" + domains[i] + ":3000/";
      var img_url = url + "puppy.jpg";
      img.setAttribute("src", img_url);
      img.alt = "puppy";
      img.style="width:300px; height:300px;";
      var iframe_url = url + "cat-iframe." + i + ".html";
      // var iframe_url = url + "cat-iframe.html";
      document.body.appendChild(img);
      img.onload=makeFrame(domains[i], iframe_url);
   }

    function deleteAllCookies() {
    var cookies = document.cookie.split(";");
    for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i];
        var eqPos = cookie.indexOf("=");
        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
        document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
        }
    }

    function clearLocalStorage() {
      localStorage.clear();
    }

    function makeFrame(domainName, url) {
      ifrm = document.createElement("iframe");
      ifrmUrl = url + 
      ifrm.setAttribute("src", url);
      ifrm.style.width = 400+"px";
      ifrm.style.height = 300+"px";
      console.log("content window is " + ifrm.contentWindow);
      document.body.appendChild(ifrm);
      ifrm.onload = addDivider(ifrm, domainName, url);
    }

    function addDivider(ifrm, domainName, url) {
      console.log("current url is " + window.location.href);
      console.log("url is " + url);
      // ifrm.contentWindow.postMessage(domainName, url);
      document.body.appendChild(document.createElement('hr'));      
    }
</script>

</body>

</html>
